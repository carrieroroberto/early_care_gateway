@startuml

interface IUserRepository {
  + findByEmail(email: String) : User
  + findByResetToken(tokenHash: String) : User
  + save(user: User)
  + update(user: User)
}
class UserRepositoryImpl implements IUserRepository {
  - dbConnection
  + findByEmail(email: String) : User
  + save(user: User)
  + update(user: User)
}

interface IAuditNotifier {
  + notify(eventType: String, details: Map)
}
class AuditClient implements IAuditNotifier {
  - httpClient
  + notify(eventType: String, details: Map)
}

class AuthenticationService {
  - userRepository: IUserRepository
  - auditNotifier: IAuditNotifier
  - passwordHasher
  - jwtSigner

  + register(data: RegisterRequest)
  + login(data: LoginRequest) : TokenResponse
  + validateToken(token: String) : String
}

AuthenticationService o-- "1" IUserRepository
AuthenticationService o-- "1" IAuditNotifier

@enduml